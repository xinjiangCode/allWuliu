<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Cache-Control" CONTENT="no-cache">
    <meta http-equiv="Pragma" content="no-cache">
    <meta name="format-detection" content="telephone=no" />
    <title>新疆物流服务平台</title>
    <script src="../js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script>
        //在首页点击发布空车
        if(sessionStorage.getItem("isAdd")==1){
            window.location.href="./depart.html";
            sessionStorage.setItem("isAdd",0);
        }
    </script>
    <link rel="stylesheet" type="text/css" href="../css/commin.css"/>
    <link rel="stylesheet" href="../css/dataIndex.css">
    <style>
        .conTitleLeft img{margin-right: 2px;}
        .orderItem{padding: 20px 10px;width: 94px;}
        .totalNumber{margin-right: 5px;}
    </style>
</head>
<body>
    <div class="container">
        <!--<div class="conTitle clearFloat">-->
            <!--<div class="Lf clearFloat conTitleLeft">-->
                <!--<div class="Lf " style="font-size: 16px;">企业名称</div>-->
                <!--<div class="Lf titleLine"></div>-->
                <!--<div class="Lf"><img src="../img/cf_dataTitle1.png" alt="">信用</div>-->
                <!--<div class="Lf titleLine"></div>-->
                <!--<div class="Lf"><img src="../img/cf_dataTitle2.png" alt="">危化</div>-->
                <!--<div class="Lf titleLine"></div>-->
                <!--<div class="Lf"><img src="../img/cf_dataTitle3.png" alt="">一级运输</div>-->
                <!--<div class="Lf titleLine"></div>-->
                <!--<div class="Lf"><img src="../img/cf_dataTitle4.png" alt="">企业信息</div>-->
            <!--</div>-->
            <!--<div class="cf_btn" style="float: right;margin-top: 7px;" onclick="goDepart()"><img src="../img/cf_fabu.png" alt=""><span>发布空车</span></div>-->
        <!--</div>-->
        <!--<div class="notice"><img src="../img/cf_laba.png" alt=""><span>平台按安监局相关规定，不向个人出售。请提交公司及购买资质信息进行认证才可交易。</span></div>-->
        <div class="condition clearFloat">
            <div class="time clearFloat Lf">
                <div class="cf_btn Lf on" data-id="1">最近七日</div>
                <div class="cf_btn Lf" data-id="2">最近一月</div>
                <div class="cf_btn Lf" data-id="3" style="border-right: none;">最近三月</div>
            </div>
            <div class="dataTime Lf">
                <span style="color: #666666;font-size: 14px;margin-right: 5px;">检索条件</span>
                <input type="text" class="date-input laydate-icon kuang start" style="width: 129px;height: 38px;" placeholder="请选择日期" id="test1">
                <span style="height: 38px;line-height: 38px;">&nbsp;-&nbsp; </span>
                <input type="text" class="date-input laydate-icon kuang end" style="width: 129px;height: 38px;" placeholder="请选择日期" id="test2">
            </div>
            <!--<div class="Rt cfRefresh" style="width: 92px;height: 36px;border: 1px solid #f1f1f1;line-height: 36px;margin-top: 4px;"><img style="margin: 12px 5px 0 15px;" src="../img/cf_shuaxin.png" alt="">刷新</div>-->
        </div>
        <div class="orderList clearFloat">
            <div class="orderItem daiqueren">
                <div class="orderStatus">
                    <img src="../img/cf_wenhao.png" alt=""><span>待确认</span>
                </div>
                <div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>
                <!--<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>-->
            </div>
            <div class="orderItem weihezuoxuqiu">
                <div class="orderStatus">
                    <img src="../img/cf_wenhao.png" alt=""><span>未合作订单</span>
                </div>
                <div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>
                <!--<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>-->
            </div>
            <div class="orderItem yihezuoxuqiu">
                <div class="orderStatus">
                    <img src="../img/cf_wenhao.png" alt=""><span>已合作</span>
                </div>
                <div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>
                <!--<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>-->
            </div>
            <div class="orderItem daifenpei">
                <div class="orderStatus">
                    <img src="../img/cf_wenhao.png" alt=""><span>待分配</span>
                </div>
                <div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>
                <!--<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>-->
            </div>
            <div class="orderItem jinxingzhong">
                <div class="orderStatus">
                    <img src="../img/cf_wenhao.png" alt=""><span>进行中订单</span>
                </div>
                <div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>
                <!--<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>-->
            </div>
            <div class="orderItem wcDaishenhe" >
                <div class="orderStatus">
                    <img src="../img/cf_wenhao.png" alt=""><span>财务待审核</span>
                </div>
                <div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>
                <!--<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>-->
            </div>
            <div class="orderItem wanchen">
                <div class="orderStatus">
                    <img src="../img/cf_wenhao.png" alt=""><span>已完成</span>
                </div>
                <div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>
                <!--<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>-->
            </div>
            <!--<div class="orderItem quxiao" style="margin-right: 0;">-->
                <!--<div class="orderStatus">-->
                    <!--<img src="../img/cf_wenhao.png" alt=""><span>结束订单</span>-->
                <!--</div>-->
                <!--<div style="text-align: center;margin-top: 12px;"><span class="orderNumber"></span><span style="font-size: 16px;">笔</span></div>-->
                <!--&lt;!&ndash;<div style="font-size: 14px;text-align: center"><span class="orderWeight"></span><span>吨</span></div>&ndash;&gt;-->
            <!--</div>-->
        </div>

        <div class="totalList clearFloat">
            <div data-id="1" class="totalItem Lf dindanshu">
                <div class="Lf totalLeft clearFloat">
                    <div class="totalImgs">
                        <img src="../img/cf_total1.png" alt="">
                    </div>
                    <div class="totalTitle cf_btn" style="background-color: #FF9F59;">订单数</div>
                </div>
                <div class="Lf totalRight">
                    <div class="Lf totalNumber" style="color: #FF9F59;"></div>
                    <div class="Lf" style="margin-top: 60px;">
                        <div>笔</div>
                        <!--<div><span class="totalWeight"></span><span>吨</span></div>-->
                    </div>
                </div>
            </div>
            <div data-id="2" class="totalItem Lf zaitu">
                <div class="Lf totalLeft clearFloat">
                    <div class="totalImgs">
                        <img src="../img/cf_total2.png" alt="">
                    </div>
                    <div class="totalTitle cf_btn" style="background-color: #FF6767;">在途车辆</div>
                </div>
                <div class="Lf totalRight">
                    <div class="Lf totalNumber" style="color: #FF4242;"></div>
                    <div class="Lf" style="margin-top: 60px;">
                        <div>辆</div>
                        <!--<div><span class="totalWeight"></span><span>吨</span></div>-->
                    </div>
                </div>
            </div>
            <div data-id="3" class="totalItem Lf zongjine" style="margin-right: 0">
                <div class="Lf totalLeft clearFloat">
                    <div class="totalImgs">
                        <img src="../img/cf_total3.png" alt="">
                    </div>
                    <div class="totalTitle cf_btn" style="background-color: #ACD180;">总金额</div>
                </div>
                <div class="Lf totalRight">
                    <div class="Lf totalNumber" style="color: #84C339;"></div>
                    <div class="Lf" style="margin-top: 60px;">
                        <div class="moneyUnit"></div>
                        <!--<div><span class="totalWeight"></span><span>吨</span></div>-->
                    </div>
                </div>
            </div>
            <div data-id="4" class="totalItem Lf yijiesuan">
                <div class="Lf totalLeft clearFloat">
                    <div class="totalImgs">
                        <img src="../img/cf_total4.png" alt="">
                    </div>
                    <div class="totalTitle cf_btn" style="background-color: #DC715B;">已结算</div>
                </div>
                <div class="Lf totalRight">
                    <div class="Lf totalNumber" style="color: #DC715B"></div>
                    <div class="Lf" style="margin-top: 60px;">
                        <div>笔</div>
                        <!--<div><span class="totalWeight"></span><span>吨</span></div>-->
                    </div>
                </div>
            </div>
            <div data-id="5" class="totalItem Lf clearFloat daijiesuan">
                <div class="Lf totalLeft clearFloat">
                    <div class="totalImgs">
                        <img src="../img/cf_total5.png" alt="">
                    </div>
                    <div class="totalTitle cf_btn" style="background-color: #86B2FF;">待结算</div>
                </div>
                <div class="Lf totalRight">
                    <div class="Lf totalNumber" style="color: #4F8BF3;"></div>
                    <div class="Lf" style="margin-top: 60px;">
                        <div>笔</div>
                        <!--<div><span class="totalWeight"></span><span>吨</span></div>-->
                    </div>
                </div>
            </div>
        </div>

        <div class="myEacheerts clearFloat" id="myEacheerts1">

        </div>
        <div style="display: none;"  class="myEacheerts clearFloat" id="myEacheerts2">

        </div>
    </div>


<script src="../js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/pager.js" type="text/javascript" charset="utf-8"></script>
<script src="../js/common.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/echarts.min.js"></script>
    <script type="text/javascript" src="http://echarts.baidu.com/gallery/vendors/echarts/map/js/china.js"></script>
    <script src="../laydate/laydate.js"></script> <!-- 改成你的路径 -->
<script type="text/javascript">
    //Iframe 的高度
    $(function () {
        window.parent.$("#Iframe").css("height","810");
    })

    laydate({
        elem: '#test1',
        format: 'YYYY-MM-DD',
        istime: true,
        choose: function(dates){ //选择好日期的回调
            if(dates>$("#test2").val()){
                $("#test2").val("")
            }
            getdata($(".time .on").attr("data-id"),1);
        }
    })
    laydate({
        elem: '#test2',
        format: 'YYYY-MM-DD',
        istime: true,
        choose: function(dates){ //选择好日期的回调
            if(dates<$("#test1").val()){
                $("#test2").val("")
            }
            getdata($(".time .on").attr("data-id"),1);
        }
    })

//    选择月份
$(".time .cf_btn").click(function () {
    $(".time .cf_btn").removeClass("on");
    $(this).addClass("on");
    getdata($(this).attr("data-id"),1);
})

//    选择五大订单
$(".totalList .totalItem").click(function () {
    $(".totalList .totalItem").removeClass("on");
    $(this).addClass("on");
    getData3($(".time .on").attr("data-id"),$(this).attr("data-id"));
})

    getdata($(".time .on").attr("data-id"),1);
    //    获取 数据
    function getdata(type,ty) {
        getData1(type)
        getData2(type)
        getData3(type,ty)
    }
    function getData1(type){
        $.ajax({
            url: pubIP + "wltCompanyUp/getStatisticsCys",
            type: 'post',
            headers: {
                Accept: "application/json; charset=utf-8",
                token: token
            },
            data: {
                type:type,
                date1:$("#test1").val(),
                date2:$("#test2").val()
            },
            cache: false,
            dataType: 'json',
            success: function (res) {
                if(res.code==1){
                    renderOrderItem("weihezuoxuqiu",res.weihezuoxuqiu)
                    renderOrderItem("wcDaishenhe",res.wcDaishenhe)
                    renderOrderItem("jinxingzhong",res.jinxingzhong)
                    renderOrderItem("yihezuoxuqiu",res.yihezuoxuqiu)
                    renderOrderItem("daiqueren",res.daiqueren)
                    renderOrderItem("wanchen",res.wanchen)
                    renderOrderItem("daifenpei",res.daifenpei)
                    renderOrderItem("quxiao",res.quxiao)
                }
            },
            error: function(err){
                console.log(err);
            }
        });
    }
    function getData2(type){
        $.ajax({
            url: pubIP + "wltCompanyUp/getStatisticsCys2",
            type: 'post',
            headers: {
                Accept: "application/json; charset=utf-8",
                token: token
            },
            data: {
                type:type,
                date1:$("#test1").val(),
                date2:$("#test2").val()
            },
            cache: false,
            dataType: 'json',
            success: function (res) {
                renderOrderItem2("zongjine",res.zongjine)
                renderOrderItem2("zaitu",res.zaitu)
                renderOrderItem2("daijiesuan",res.daijiesuan)
                renderOrderItem2("dindanshu",res.dindanshu)
                renderOrderItem2("yijiesuan",res.yijiesuan)
            },
            error: function(err){
                console.log(err);
            }
        });
    }
    function getData3(type,ty){
        $.ajax({
            url: pubIP + "wltCompanyUp/getStatisticsCys3",
            type: 'post',
            headers: {
                Accept: "application/json; charset=utf-8",
                token: token
            },
            data: {
                type:type,
                date1:$("#test1").val(),
                date2:$("#test2").val(),
                ty:ty
            },
            cache: false,
            dataType: 'json',
            success: function (res) {
                if(res.code==1){
                    var dates=[];
                    var num1=[];
                    var num2=[];
                    $.each(res.data,function (idx,item) {
                        dates.push(item.dates)
                        if(ty==3){//总金额使用 num2
                            num1.push(item.num2)
                        }else{
                            num1.push(item.num1)
                        }
                    })
                    
                    getEach(dates,num1,"myEacheerts1",ty)
//                    getEach(res.data3,res.data2,"myEacheerts2")
                }
            },
            error: function(err){
                console.log(err);
            }
        });
    }
//    八个订单状态对应的数量渲染
    function renderOrderItem(cls,values) {
        $("."+cls+" .orderNumber").text(values.num1)
        if(values.num2==null || values.num2==""){
            $("."+cls+" .orderWeight").text("0");
        }else{
            $("."+cls+" .orderWeight").text(values.num2)
        }
    }
    //    五个订单状态对应的数量渲染
    function renderOrderItem2(cls,values) {
        if(cls=="zongjine"){
            $("."+cls+" .totalNumber").text(values.num2==null?"0":values.num2)
        }else{
            $("."+cls+" .totalNumber").text(values.num1)
        }

        $(".moneyUnit").text("元");//暂时先写元

        if(values.num2==null || values.num2==""){
            $("."+cls+" .totalWeight").text("0");
        }else{
            $("."+cls+" .totalWeight").text(values.num2)
        }
    }

</script>

    <!-- 柱形图 -->
    <script type="text/javascript">
//        data1 横坐标  data2纵坐标   id渲染ID
        function getEach(dates,num1,id,ty) {
            var unit=""
            var name=""
            if(ty==1){
                unit="笔"
                name="订单数"
            }else if(ty==2){
                unit="辆"
                name="在途车辆"
            }else if(ty==3){
                unit="元"
                name="总金额"
            }else if(ty==4){
                unit="笔"
                name="已结算"
            }else if(ty==5){
                unit="笔"
                name="待结算"
            }




            var dom = document.getElementById(id);
            var myChart = echarts.init(dom);
            var app = {};
            option = null;
            app.title = '堆叠柱状图';

            option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'cross',
                        crossStyle: {
                            color: '#999'
                        }
                    }
                },
                toolbox: {
                    feature: {
//                        dataView: {show: true, readOnly: false},
//                        magicType: {show: true, type: ['line', 'bar']},
//                        restore: {show: true},
                        saveAsImage: {show: true}
                    }
                },
                legend: {
                    data:['num1']
                },
                xAxis: [
                    {
                        type: 'category',
                        data: dates,//纵坐标
                        axisPointer: {
                            type: 'shadow'
                        }
                    }
                ],
                yAxis: [
                    {
                        type: 'value',
                        name: name,
//                        min: 0,
//                        max: 250,
//                        interval: 50,
                        axisLabel: {
                            formatter: '{value} '+unit
                        }
                    }
                ],
                grid: {
                    left: '5%',
                    right: '5%',
                    bottom: '5%',
                    top:"15%",
                    containLabel: true
                },
                series: [
                    {
                        name:name,
                        type:'bar',
//                        barGap:"0",
                        data:num1
                    }
//                    ,
//                    {
//                        name:'num2',
//                        type:'bar',
//                        data:num2
//                    }
                ]
            };

            if (option && typeof option === "object") {
                myChart.setOption(option, true);
            }
        }


    </script>
</body>
</html>